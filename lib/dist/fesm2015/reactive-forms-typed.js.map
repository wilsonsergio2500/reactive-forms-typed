{"version":3,"file":"reactive-forms-typed.js","sources":["../../src/directives/form-control-onerror.directive.ts","../../src/FormTypeBuilder.extensions.ts","../../src/FormTypeBuilder.service.ts","../../src/ReactiveFormsTyped.Module.ts","../../reactive-forms-typed.ts"],"sourcesContent":["import { Directive, Inject, Input, ElementRef, OnInit, HostBinding, AfterContentInit, OnDestroy } from '@angular/core';\r\nimport { FormGroupDirective } from '@angular/forms';\r\nimport { Subscription, Observable, interval, of } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\n@Directive({\r\n  selector: '[formControlOnErrorItem]',\r\n})\r\nexport class FormControlOnErrorItemDirective implements OnInit, OnDestroy {\r\n\r\n  @Input('formControlOnErrorItem') formControlItem: string;\r\n  @Input() errors: any = null;\r\n  @Input() showOnFormTouched: boolean = false;\r\n  tracker: Subscription;\r\n\r\n  @HostBinding('hidden')\r\n  hidden: boolean = true;\r\n\r\n  constructor(\r\n      @Inject(FormGroupDirective) private formGroupService: FormGroupDirective, \r\n    private element: ElementRef<HTMLElement>\r\n    ) {\r\n  }\r\n\r\n  private _errors: any = {\r\n    required: \"Required\",\r\n    minlength: \"Minimum length not valid\",\r\n    maxlength: \"Exceeds the maximum length\",\r\n    isValidEmailAddress: \"Invalid email address\",\r\n    isValidSelection: \"Invalid selection\",\r\n    isStringValidByRegEx: \"Invalid character\",\r\n    isStringInRange: \"Invalid string length\",\r\n    isInRange: \"Number is outside specified range\",\r\n    isGreaterThanMin: \"Exceeds allowed value\",\r\n    doControlValuesMatch: \"Values do not match\",\r\n    email: \"Invalid email address\"\r\n  };\r\n\r\n  ngOnInit(): void {\r\n    const fgroup: any = this.formGroupService.form;\r\n\r\n    if (!!this.errors) {\r\n      this._errors = { ...this._errors, ...this.errors };\r\n    }\r\n    if (!!fgroup.__errors) {\r\n      this._errors = { ...this._errors, ...fgroup.__errors };\r\n    }\r\n    if (!!fgroup.__contractErrors && !!fgroup.__contractErrors[this.formControlItem]) {\r\n      this._errors = { ...this._errors, ...fgroup.__contractErrors[this.formControlItem] };\r\n    }\r\n\r\n    this.changeTracker();\r\n  }\r\n\r\n  changeTracker() {\r\n\r\n    const onHappen = (x: boolean) => {\r\n      this.hidden = !x;\r\n      const msg = this.hidden ? '' : this.errorMessage;\r\n      if (!!msg) {\r\n        this.element.nativeElement.innerText = msg;\r\n      }\r\n    }\r\n\r\n    this.tracker =  interval(250).pipe(map(ev => this.errorMessage && this.ControlTouched)).subscribe(onHappen);\r\n  }\r\n  get errorMessage() {\r\n\r\n    const formControl = this.formGroupService.form.get(this.formControlItem);\r\n    if (!!formControl && !!formControl.errors) {\r\n      const fgroup: any = this.formGroupService.form;\r\n\r\n      const keys = Object.keys(formControl.errors);\r\n      return (this._errors[keys[0]] || null);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  get ControlTouched() {\r\n    const formControl = this.formGroupService.form.get(this.formControlItem);\r\n    if (this.showOnFormTouched) {\r\n      if (formControl) {\r\n        return formControl.parent.touched;\r\n      }\r\n    } else {\r\n      if (formControl) {\r\n        return formControl.touched || this.formGroupService.submitted || (!!(formControl.parent as any).__submitted);\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.tracker.unsubscribe();\r\n  }\r\n}","import { Subscription } from \"rxjs\";\r\nimport { delay, tap } from \"rxjs/operators\";\r\nimport { NgTypeFormGroup } from \"./FormTypeBuilder.models\";\r\n\r\nexport interface IFormGroupPrivates{\r\n    __submitted : boolean;\r\n    __errors: any;\r\n    __contractErrors: any;\r\n    __subscriptions: Subscription[]\r\n}\r\n// @dynamic\r\nexport class FormExtendedMethods {\r\n\r\n    public static onInit = function () {\r\n        this.__submitted = false;\r\n        this.__subscriptions = [];\r\n    }\r\n\r\n    public static setErrors = function (config: any) {\r\n        this.__errors = { ...config };\r\n    }\r\n\r\n    public static setFormErrors = function (config: any) {\r\n        this.__contractErrors = { ...config };\r\n    };\r\n\r\n    public static setFormControlErrors = function (key: string, config: any) {\r\n        if (!!this.__contractErrors) {\r\n            this.__contractErrors = { ...this.__contractErrors };\r\n            this.__contractErrors[key] = config;\r\n        } else {\r\n            this.__contractErrors = {};\r\n            this.__contractErrors[key] = config;\r\n        }\r\n    }\r\n\r\n    public static markAsSubmitted = function () {\r\n        this.__submitted = true;\r\n    }\r\n\r\n    public static isSubmitted = function () {\r\n        return this.__submitted\r\n    }\r\n\r\n    public static addFormControlValidityTracker = function(from: string, to: string){\r\n      const form = this as NgTypeFormGroup<any>;\r\n        const sub$ = form.controls[from].valueChanges.pipe(\r\n            delay(1),\r\n            tap(_ => form.controls[to].updateValueAndValidity())\r\n        )\r\n        this.__subscriptions = [...this.__subscriptions, sub$.subscribe()];\r\n    }\r\n\r\n    public static unsubscribeValidityTackers = function(){\r\n        if(this.__subscriptions){\r\n            (this.__subscriptions as Subscription[]).forEach(sub => sub.unsubscribe());\r\n        }\r\n    }\r\n\r\n}\r\n","import { Injectable } from \"@angular/core\";\r\nimport {\r\n    FormBuilder as NgFormBuilder,\r\n    ValidatorFn,\r\n    AsyncValidatorFn,\r\n    AbstractControlOptions,\r\n} from \"@angular/forms\";\r\nimport { NgTypeAbstractControl, NgTypeFormControl, NgTypeFormGroup, NgTypeFormArray } from \"./FormTypeBuilder.models\";\r\nimport { FormExtendedMethods } from \"./FormTypeBuilder.extensions\";\r\n\r\n\r\n@Injectable()\r\nexport class FormTypeBuilder {\r\n\r\n    private ngFormBuilder: NgFormBuilder;\r\n    static create() {\r\n        return new FormTypeBuilder();\r\n    }\r\n\r\n    constructor() {\r\n        this.ngFormBuilder = new NgFormBuilder();\r\n    }\r\n    \r\n    group<T>(controlsConfig: { [P in keyof T] : any }, options?: AbstractControlOptions | null): NgTypeFormGroup<T> {\r\n        const formGroup = this.ngFormBuilder.group(controlsConfig, options) as NgTypeFormGroup<T>;\r\n        formGroup.onInit = FormExtendedMethods.onInit.bind(formGroup);\r\n        formGroup.setFormErrors = FormExtendedMethods.setFormErrors.bind(formGroup);\r\n        formGroup.setFormErrors = FormExtendedMethods.setFormErrors.bind(formGroup);\r\n        formGroup.setFormControlErrors = FormExtendedMethods.setFormControlErrors.bind(formGroup);\r\n        formGroup.markAsSubmitted = FormExtendedMethods.markAsSubmitted.bind(formGroup);\r\n        formGroup.isSubmitted = FormExtendedMethods.isSubmitted.bind(formGroup);\r\n        formGroup.addFormControlValidityTracker = FormExtendedMethods.addFormControlValidityTracker.bind(formGroup);\r\n        formGroup.onInit();\r\n        return formGroup;\r\n    }\r\n\r\n    control<T>(value: T, validator?: ValidatorFn | ValidatorFn[] | null, asyncValidator?: AsyncValidatorFn | AsyncValidatorFn[] | null): NgTypeFormControl<T>;\r\n    control(formState: Object, validator?: ValidatorFn | ValidatorFn[] | null, asyncValidator?: AsyncValidatorFn | AsyncValidatorFn[] | null) {\r\n        return this.ngFormBuilder.control(formState, validator, asyncValidator);\r\n    }\r\n\r\n    array<T>(controls: NgTypeAbstractControl<T>[], validator?: ValidatorFn | null, asyncValidator?: AsyncValidatorFn | null): NgTypeFormArray<T>;\r\n    array<S>(controlsConfig: any[], validator?: ValidatorFn | null, asyncValidator?: AsyncValidatorFn | null): NgTypeFormArray<S>;\r\n    array(controlsConfig: any[], validator?: ValidatorFn | null, asyncValidator?: AsyncValidatorFn | null) {\r\n        return this.ngFormBuilder.array(controlsConfig, validator, asyncValidator);\r\n    }\r\n}","\r\nimport { NgModule } from \"@angular/core\";\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule, ReactiveFormsModule } from \"@angular/forms\";\r\nimport { FormTypeBuilder } from \"./FormTypeBuilder.service\";\r\nimport { FormControlOnErrorItemDirective } from \"./directives/form-control-onerror.directive\";\r\n\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    ReactiveFormsModule\r\n  ],\r\n  declarations: [\r\n      FormControlOnErrorItemDirective\r\n  ],\r\n  exports: [\r\n      FormControlOnErrorItemDirective\r\n  ],\r\n   providers: [FormTypeBuilder],\r\n})\r\nexport class ReactiveFormsTypedModule { }\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["NgFormBuilder"],"mappings":"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"}